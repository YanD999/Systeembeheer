#!/bin/bash
if [ -n $1 ]; then

	if  [[ $1 = "-t" ]]
	then
	RECORD=$2

        if [ $record = "A" ]; then
	        echo "$3 in a $4 to db.$5"
        	echo "$3        IN      A       $4" >> /etc/bind/zones/db.$5;
       		LINK="/etc/bind/zones/db.$5"

        elif [ $record = "MX" ]; then
        	echo " @        IN      MX      10      $3.$5." >> /etc/bind/zones/db.$5
        	echo "$3        IN      A       $4" >> /etc/bind/zones/db.$5
	        LINK="/etc/bind/zones/db.$5"

        elif [ $record = "CNAME" ]; then
        	echo "$3        IN      CNAME   $4." >> /etc/bind/zones/db.$4
	        LINK="/etc/bind/zones/db.$4"

        fi

else
        echo "$1        IN      A       $2">> /etc/bind/zones/db.$3
       	LINK="/etc/bind/zones/db.$3"

fi

#increase serial
line=$(grep "Serial" "$LINK")
echo $line
var=$(echo $line |  grep -Eo '[0-9]{1,9}')
echo $var
new=$((var+1))
echo $new
new="$new   ; Serial"
echo $new
sed -i "s/.*Serial.*/\t\t\t     $new/g" "$LINK"

#reload rndc
rndc reload

#restart bind9
systemctl restart bind9
